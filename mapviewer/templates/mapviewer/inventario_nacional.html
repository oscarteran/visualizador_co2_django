{% extends 'mapviewer/base.html' %}
{% load static %}

{% block title %}Inventario Nacional{% endblock %}

{% block content %}
<div class="map-view-container">

    <!-- 1. BARRA DE CONTROLES (Tarjeta Flotante) -->
    <div class="map-control-bar">
        
        <div class="map-header-text mb-3">
            <h2 class="map-title">Distribución de principales zonas de medición en territorio nacional</h2>
            <p class="map-subtitle">Mapas interactivos para revisión de datos de emisiones de $\text{CO}_2$.</p>
        </div>

        <!-- FILTROS: Envuelta en un formulario para envío de parámetros GET -->
        <form id="map-filter-form" method="GET" class="filter-toolbelt">
            
            <!-- Campo oculto para mantener la consistencia de la URL si se requiere -->
            <!-- <input type="hidden" name="ubicacion" value="{{ ubicacion_seleccionada }}"> -->

            <!-- Filtro de Capas/Tipo de Mapa -->
            <div class="map-filter-group me-4">
                <label for="tipo_mapa" class="form-label small-label">Capas de Visualización</label>
                <select name="tipo_mapa" id="tipo_mapa" class="form-select custom-select">
                    {% for opcion in opciones_mapa %}
                        <option value="{{ opcion }}" {% if opcion == tipo_mapa_seleccionado %}selected{% endif %}>{{ opcion }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Ejemplo de Filtro de Ubicación Adicional (Se puede integrar en la vista) -->
            <div class="map-filter-group">
                <label for="ubicacion_filtro" class="form-label small-label">Ubicación Específica</label>
                <select id="ubicacion_filtro" class="form-select custom-select">
                    <option value="">Todas las ubicaciones</option>
                    <!-- Aquí iría un bucle si tuvieras una lista de ubicaciones para el filtro -->
                    <!-- {% for ubicacion in ubicaciones %} ... {% endfor %} -->
                </select>
            </div>
            
        </form>
    </div>
    
    <!-- 2. CONTENEDOR DEL MAPA (Tarjeta Flotante Grande) -->
    <div class="map-container-wrapper">
        <!-- El mapa se renderiza aquí -->
        <div class="map-content-area">
            {{ mapa|safe }}
        </div>
        
        <!-- Tarjeta de Leyenda (Ejemplo de elemento flotante sobre el mapa) -->
        <div class="map-legend-box">
            <h5 class="legend-title">Leyenda:</h5>
            <div class="legend-item">
                <span style="background-color: #38B2AC;"></span> Bajo
            </div>
            <div class="legend-item">
                <span style="background-color: #FFC107;"></span> Medio
            </div>
            <div class="legend-item">
                <span style="background-color: #DC3545;"></span> Alto
            </div>
        </div>
        
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'mapviewer/js/map_controls.js' %}"></script>
{% endblock %}
